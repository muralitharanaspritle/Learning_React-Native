{"version":3,"sources":["DateMonthYearField.tsx"],"names":["React","createRef","View","Keyboard","int","isValidDate","formatYearDigits","getOnlyNumber","getDateDefault","daysInMonth","dateInRange","Input","styles","DateMonthYearField","Component","props","defaultValue","value","date","setState","length","refMonth","current","focus","month","state","refYear","year","dismiss","hideDate","maximumDate","minimumDate","handleErrors","onSubmit","padStart","Date","getFullYear","componentDidMount","autoFocus","refDate","UNSAFE_componentWillReceiveProps","nextProps","JSON","stringify","nextState","render","testID","containerStyle","styleInput","styleInputYear","labelDate","labelMonth","labelYear","editable","placeholderTextColor","container","onChangeDate","onBlur","onChangeMonth","onChangeYear"],"mappings":"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","sourcesContent":["import React, { createRef } from 'react';\nimport { View, Keyboard, TextInput } from 'react-native';\nimport {\n  int,\n  isValidDate,\n  formatYearDigits,\n  getOnlyNumber,\n  getDateDefault,\n  daysInMonth,\n  dateInRange,\n} from './utils';\nimport Input from './Input';\nimport type { DateFieldProps } from './types';\nimport styles from './styles';\n\ntype State = {\n  date: string;\n  month: string;\n  year: string;\n};\n\nclass DateMonthYearField extends React.Component<DateFieldProps, State> {\n  static defaultProps = {\n    labelDate: 'Date',\n    labelMonth: 'Month',\n    labelYear: 'Year',\n    editable: true,\n  };\n\n  state = { ...getDateDefault(this.props.defaultValue) };\n\n  refDate = createRef<TextInput>();\n  refMonth = createRef<TextInput>();\n  refYear = createRef<TextInput>();\n\n  componentDidMount() {\n    if (this.props.autoFocus) {\n      this.refDate.current?.focus();\n    }\n  }\n\n  UNSAFE_componentWillReceiveProps(nextProps: DateFieldProps) {\n    if (\n      JSON.stringify(getDateDefault(nextProps.value)) !==\n      JSON.stringify(getDateDefault(this.props.value))\n    ) {\n      const { date, month, year } = getDateDefault(nextProps.value);\n      const nextState = {\n        date: date ? date.padStart(2, '0') : '',\n        month: month ? month.padStart(2, '0') : '',\n        year,\n      };\n      this.setState(nextState);\n    }\n  }\n\n  onChangeDate = (value: string) => {\n    const date = getOnlyNumber(int(value) > 31 ? '31' : value);\n    this.setState({ date });\n    if (date.length === 2) {\n      this.refMonth.current?.focus();\n    }\n  };\n\n  onChangeMonth = (value: string) => {\n    const month = getOnlyNumber(int(value) > 12 ? '12' : value);\n    this.setState({\n      month,\n      date: daysInMonth(this.state),\n    });\n    if (month.length === 2) {\n      this.refYear.current?.focus();\n    }\n  };\n\n  onChangeYear = (value: string) => {\n    const year = getOnlyNumber(value);\n    this.setState({ year }, () => {\n      if (year.length === 4) {\n        Keyboard.dismiss();\n      }\n    });\n  };\n\n  onBlur = () => {\n    const {\n      hideDate,\n      maximumDate,\n      minimumDate,\n      handleErrors,\n      onSubmit,\n    } = this.props;\n    const current = { ...this.state };\n    if (int(current.date) === 0 || hideDate) {\n      current.date = '01';\n    }\n    if (current.date.length === 1) {\n      current.date = current.date.padStart(2, '0');\n    }\n    if (int(current.month) === 0) {\n      current.month = '01';\n    }\n    if (current.month.length === 1) {\n      current.month = current.month.padStart(2, '0');\n    }\n    if (int(current.year) === 0) {\n      current.year = `${new Date().getFullYear()}`;\n    }\n    if (current.year.length > 1 && current.year.length < 4) {\n      current.year = `${formatYearDigits(int(current.year))}`;\n    }\n    const value = new Date(\n      int(current.year),\n      int(current.month) - 1, // new Date(year, monthIndex, day)\n      int(current.date)\n    );\n    if (current.year) {\n      if (\n        (minimumDate || maximumDate) &&\n        !dateInRange(value, minimumDate, maximumDate)\n      ) {\n        handleErrors && handleErrors();\n        this.setState({ date: '', month: '', year: '' });\n      } else {\n        if (isValidDate(value)) {\n          onSubmit && onSubmit(value);\n        }\n        this.setState({ ...current });\n      }\n    }\n  };\n\n  render() {\n    const { date, month, year } = this.state;\n    const {\n      testID,\n      containerStyle,\n      styleInput,\n      styleInputYear,\n      labelDate,\n      labelMonth,\n      labelYear,\n      editable,\n      hideDate,\n      placeholderTextColor,\n    } = this.props;\n\n    return (\n      <View {...{ testID }} style={[styles.container, containerStyle]}>\n        {!hideDate && (\n          <Input\n            ref={this.refDate}\n            value={date}\n            placeholder={labelDate}\n            style={styleInput}\n            onChangeText={this.onChangeDate}\n            onSubmitEditing={() => this.refMonth.current?.focus()}\n            onBlur={this.onBlur}\n            {...{ editable, placeholderTextColor }}\n          />\n        )}\n        <Input\n          ref={this.refMonth}\n          value={month}\n          placeholder={labelMonth}\n          style={styleInput}\n          onChangeText={this.onChangeMonth}\n          onSubmitEditing={() => this.refYear.current?.focus()}\n          onBlur={this.onBlur}\n          {...{ editable, placeholderTextColor }}\n        />\n        <Input\n          ref={this.refYear}\n          value={year}\n          maxLength={4}\n          returnKeyType=\"done\"\n          placeholder={labelYear}\n          style={[styleInput, styleInputYear]}\n          onChangeText={this.onChangeYear}\n          onSubmitEditing={() => Keyboard.dismiss()}\n          onBlur={this.onBlur}\n          {...{ editable, placeholderTextColor }}\n        />\n      </View>\n    );\n  }\n}\n\nexport default DateMonthYearField;\n"]}